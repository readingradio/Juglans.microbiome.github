# this script counts sequences from branch samples from fasta files at each step
#
# I double checked the sequence numbers by using the unix command wc -l (word count) on the output files and dividing by two.
#
set.dir(input=/scratch/brown/will1809/Phyllo.mb.jn.parallel, output=/scratch/brown/will1809/Phyllo.mb.jn.parallel)
#
##### TOTAL ITS1+2 SEQS LEAVES+BRANCHES
#
# wc -l phyllo.mb.demulti.fasta
# 17393638 phyllo.mb.demulti.fasta
# 17393638 / 2= 8696819
#
##### TOTAL ITS2 SEQS LEAVES+BRANCHES
#
# wc -l phyllo.mb.its2.fasta
# 10629202 phyllo.mb.its2.fasta
# 10629202 / 2= 5314601
#
######################
###### BRANCHES ######
######################
#
### TOTAL ITS1+2 CONTIGS phyllo.mb.demulti.fasta
#
get.groups(fasta=phyllo.mb.demulti.fasta, group=merge.groups, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#
#
### TOTAL ITS2 CONTIGS phyllo.mb.its2.fasta
#
get.groups(fasta=phyllo.mb.its2.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#Selected 2947904 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.pick.fasta
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/merge.pick.groups
#
### SCREEN.SEQS OUTPUT phyllo.mb.its2.good.fasta
#
get.groups(fasta=phyllo.mb.its2.good.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#Selected 2730398 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.good.pick.fasta
#
### UNIQUE.SEQS OUTPUT phyllo.mb.its2.good.unique.fasta
#
get.groups(fasta=phyllo.mb.its2.good.unique.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#Selected 133585 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.good.unique.pick.fasta
#
### PRE.CLUSTER OUTPUT phyllo.mb.its2.good.unique.precluster.fasta
#
get.groups(fasta=phyllo.mb.its2.good.unique.precluster.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#
#Selected 50708 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.good.unique.precluster.pick.fasta
#
# had to rename and re-remove seqs since we accidentally overwrote phyllo.mb.its2.good.unique.precluster.pick.fasta
rename.file(input=phyllo.mb.its2.good.unique.precluster.pick.fasta, new=phyllo.mb.its2.good.unique.precluster.branches.fasta)
remove.seqs(fasta=phyllo.mb.its2.good.unique.precluster.fasta, accnos=phyllo.mb.its2.good.unique.precluster.denovo.vsearch.accnos)
#
#Removed 7569 sequences from your fasta file.
#
#Output File Names: 
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.good.unique.precluster.pick.fasta
#
#
### CHIMERA.VSEARCH OUTPUT phyllo.mb.its2.good.unique.precluster.pick.fasta
#
get.groups(fasta=phyllo.mb.its2.good.unique.precluster.pick.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#
#Selected 44322 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/phyllo.mb.its2.good.unique.precluster.pick.pick.fasta
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/merge.phyllo.mb.its2.good.unique.precluster.branches.pick.groups
#
### REMOVE.LINEAGE OUTPUT RENAMED TO Phyllo.ITS2.jn.Oct2019.fasta
#
get.groups(fasta=Phyllo.ITS2.jn.Oct2019.fasta, group=current, groups=IN_MCB10_272s_S46_L001_R1_001-IN_MCB11_272s_S7_L001_R1_001-IN_MCB16_132s_S70_L001_R1_001-IN_MCB17_132s_S78_L001_R1_001-IN_MCB24_272s_S94_L001_R1_001-IN_MCB26_130s_S62_L001_R1_001-IN_MCB27_132s_S86_L001_R1_001-IN_MCB28_WTs_S15_L001_R1_001-IN_MCB2_130s_S38_L001_R1_001-IN_MCB7_55s_S22_L001_R1_001-IN_MCB6_55s_S14_L001_R1_001-IN_MCB8_55s_S30_L001_R1_001-IN_MCB9_130s_S54_L001_R1_001-IN_WT_MCB_29s_S23_L001_R1-IN_WT_MCB_33s_S31_L001_R1-TN_130_As_S71_L001_R1_001-TN_130_Bs_S79_L001_R1_001-TN_130_Cs_S87_L001_R1_001-TN_132_As_S95_L001_R1_001-TN_132_Bs_S47_L001_R1_001-TN_132_Cs_S8_L001_R1_001-TN_272_As_S16_L001_R1_001-TN_272_Bs_S24_L001_R1_001-TN_272_Cs_S32_L001_R1_001-TN_55_As_S39_L001_R1_001-TN_55_Bs_S55_L001_R1_001-TN_55_Cs_S63_L001_R1_001-TN_LS_1s_S40_L001_R1_001-TN_LS_2s_S56_L001_R1_001-TN_LS_3s_S64_L001_R1_001-TN_WT_MB_19s_S72_L001_R1-TN_WT_MB_20s_S80_L001_R1-TN_WT_MB_21s_S88_L001_R1-WA_BNL17_272s_S77_L001_R1_001-WA_BNL18_272s_S85_L001_R1_001-WA_BNL19_55s_S13_L001_R1_001-WA_BNL20_130s_S29_L001_R1_001-WA_BNL21_WTs_S93_L001_R1_001-WA_BNL22_WTs_S45_L001_R1_001-WA_BNL23_WTs_S6_L001_R1_001-WA_RN10_272s_S69_L001_R1_001-WA_RN1_55s_S44_L001_R1_001-WA_RN2_55s_S5_L001_R1_001-WA_RN4_130s_S21_L001_R1_001-WA_RN7_132s_S37_L001_R1_001-WA_RN8_132s_S53_L001_R1_001-WA_RN9_132s_S61_L001_R1_001)
#Selected 19697 sequences from your fasta file.
#Selected 4563811 sequences from your group file.
#
#Output File names:
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/Phyllo.ITS2.jn.Oct2019.pick.fasta
#/scratch/brown/will1809/Phyllo.mb.jn.parallel/merge.phyllo.mb.its2.good.unique.precluster.branches.pick.pick.groups
#
quit()
